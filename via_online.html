<!DOCTYPE html>
<html lang="id">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Arunika Shop - Via Online</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #121212;
            color: #e0e0e0;
        }
        #main-title {
            font-family: 'Cinzel', serif;
            font-size: 3rem;
            color: #FFD700;
        }
        .main-nav-btn {
            background-color: #2a2a2a;
            color: #FFD700;
            transition: all 0.2s ease-in-out;
        }
        .main-nav-btn.active, .main-nav-btn:hover {
            background-image: linear-gradient(to right, #B8860B, #FFD700);
            box-shadow: 0 4px 6px -1px rgba(255, 215, 0, 0.1), 0 2px 4px -1px rgba(255, 215, 0, 0.05);
            color: #1a1a1a;
        }
        .product-card {
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        }
        .product-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(255, 215, 0, 0.1), 0 4px 6px -2px rgba(255, 215, 0, 0.05);
        }
        .platform-btn-shopee { background-color: #FF5722; color: white; }
        .platform-btn-shopee:hover { background-color: #E64A19; }
        .platform-btn-tokopedia { background-color: #03AC0E; color: white; }
        .platform-btn-tokopedia:hover { background-color: #028A0B; }
        .platform-btn-lazada { background-color: #0F79F1; color: white; }
        .platform-btn-lazada:hover { background-color: #0D69D0; }
        .platform-btn-lainnya { background-color: #4B5563; color: white; }
        .platform-btn-lainnya:hover { background-color: #374151; }

        /* Gaya untuk Tombol Filter Kategori Modern */
        .category-btn {
            padding: 0.5rem 1rem;
            border-radius: 9999px; /* Bentuk pil */
            background-color: #374151; /* gray-700 */
            color: #e0e0e0;
            font-size: 0.875rem; /* text-sm */
            font-weight: 500; /* medium */
            cursor: pointer;
            transition: all 0.2s ease;
            border: 1px solid #4B5563; /* gray-600 */
            white-space: nowrap;
        }
        .category-btn:hover {
            background-color: #4B5563;
            border-color: #6B7280;
        }
        .category-btn.active {
            background-color: #F59E0B; /* amber-500 */
            color: #1f2937; /* gray-800 */
            font-weight: 700; /* bold */
            border-color: #F59E0B;
        }
    </style>
</head>
<body class="bg-gray-900 text-gray-200 p-4 md:p-8">

    <div class="max-w-4xl mx-auto bg-gray-800 p-6 md:p-10 rounded-3xl shadow-2xl">
        <header class="text-center mb-6">
            <h1 id="main-title" class="font-extrabold text-gray-200 mb-2 tracking-tight">Arunika Shop</h1>
            <p class="text-lg text-gray-400">Jastip & Rekomendasi Produk Pilihan</p>
        </header>

        <nav class="flex justify-center space-x-2 mb-6 p-1 bg-black/20 rounded-xl">
            <a href="index.html" class="main-nav-btn py-2 px-4 rounded-lg font-medium transition-colors duration-200 flex-1 text-center">Jastip</a>
            <a href="via_online.html" class="main-nav-btn active py-2 px-4 rounded-lg font-medium transition-colors duration-200 flex-1 text-center">Via Online</a>
        </nav>

        <div>
            <h2 class="text-2xl font-bold mb-4 text-center">Rekomendasi Produk Online</h2>
             <div class="relative mb-4">
                <input type="text" id="search-input" placeholder="Cari produk rekomendasi..." class="w-full bg-gray-700 text-gray-200 border border-gray-600 rounded-lg p-3 pl-10 focus:outline-none focus:ring-2 focus:ring-amber-500">
                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-search text-gray-400"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></svg></div>
            </div>

            <div id="category-filters" class="flex flex-wrap justify-center gap-2 mb-6">
                </div>

            <div id="affiliate-product-list" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 md:gap-6">
                </div>
            <p id="loading-message" class="text-center text-gray-500 my-8">Memuat produk...</p>
            <p id="no-results-message" class="text-center text-gray-500 my-8 hidden">Tidak ada produk yang cocok dengan filter Anda.</p>
        </div>
    </div>
    
    <footer class="mt-8 text-center text-gray-500 text-sm">
        <p>Copyright &copy; by Arunika Shop 2025</p>
    </footer>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getFirestore, collection, onSnapshot, query, orderBy } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyAdYbsk_p1mIvf7NXd2cLaQAFBP2mrxtuI",
            authDomain: "jastip-arunika.firebaseapp.com",
            projectId: "jastip-arunika",
            storageBucket: "jastip-arunika.appspot.com",
            messagingSenderId: "272195022487",
            appId: "1:272195022487:web:f9b3cfe42170c5bd6983d2"
        };
        
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        const productListDiv = document.getElementById('affiliate-product-list');
        const loadingMessage = document.getElementById('loading-message');
        const noResultsMessage = document.getElementById('no-results-message');
        const searchInput = document.getElementById('search-input');
        const categoryFiltersDiv = document.getElementById('category-filters');
        
        let allProducts = [];
        let activeCategory = 'Semua';
        let searchTerm = '';

        function createProductCard(product) {
            const productElement = document.createElement('div');
            productElement.className = 'product-card bg-gray-700 rounded-xl shadow-md border border-gray-600 flex flex-col p-4';
            
            const platformLower = product.platform ? product.platform.toLowerCase() : 'lainnya';
            const platformClass = `platform-btn-${platformLower}`;

            productElement.innerHTML = `
                <img src="${product.imageUrl}" alt="${product.name}" class="w-full h-32 md:h-40 object-cover rounded-lg mb-4">
                <div class="w-full text-center mb-4 flex-grow">
                    <h3 class="font-semibold text-sm md:text-base text-gray-200">${product.name}</h3>
                    <p class="text-xs md:text-sm text-gray-400 mt-1">${product.category}</p>
                </div>
                <a href="${product.affiliateLink}" target="_blank" class="w-full text-center py-2 px-4 ${platformClass} font-bold rounded-lg transition-colors text-sm">
                    Beli di ${product.platform}
                </a>
            `;
            return productElement;
        }

        function renderProducts(productsToRender) {
            productListDiv.innerHTML = '';
            loadingMessage.classList.add('hidden');
            noResultsMessage.classList.toggle('hidden', productsToRender.length > 0);
            productsToRender.forEach(product => productListDiv.appendChild(createProductCard(product)));
        }

        function applyFiltersAndRender() {
            let filtered = [...allProducts];

            if (activeCategory !== 'Semua') {
                filtered = filtered.filter(p => p.category === activeCategory);
            }

            if (searchTerm) {
                const lowerCaseSearch = searchTerm.toLowerCase();
                filtered = filtered.filter(p => p.name.toLowerCase().includes(lowerCaseSearch));
            }
            renderProducts(filtered);
        }

        function handleCategoryClick(event) {
            activeCategory = event.target.dataset.category;
            document.querySelectorAll('.category-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            applyFiltersAndRender();
        }

        function populateCategoryFilters(products) {
            const categories = ['Semua', ...new Set(products.map(p => p.category).filter(Boolean).sort())];
            categoryFiltersDiv.innerHTML = '';
            categories.forEach(category => {
                const button = document.createElement('button');
                button.className = 'category-btn';
                button.textContent = category;
                button.dataset.category = category;
                if (category === activeCategory) button.classList.add('active');
                button.addEventListener('click', handleCategoryClick);
                categoryFiltersDiv.appendChild(button);
            });
        }

        searchInput.addEventListener('input', (e) => {
            searchTerm = e.target.value.trim();
            applyFiltersAndRender();
        });

        const productsCollectionRef = collection(db, 'affiliate_products');
        onSnapshot(query(productsCollectionRef, orderBy("name")), (snapshot) => {
            allProducts = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
            populateCategoryFilters(allProducts);
            applyFiltersAndRender();
        }, (error) => {
            console.error("Error fetching affiliate products:", error);
            loadingMessage.textContent = 'Gagal memuat produk.';
        });
    </script>
</body>
</html>